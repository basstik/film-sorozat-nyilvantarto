<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      >

    <f:metadata>
        <f:viewParam name="seriesid" value="#{seriesEdit.idOfSeries}" />
        <!--<f:event type="postAddToView" listener="#{seriesEdit.loadDatabaseData}" />-->
    </f:metadata>

    <h:head>
        <title>Series edit site</title>

        <link rel="stylesheet" href="#{request.contextPath}/resources/font-awesome/css/font-awesome.min.css"/>


        <style type="text/css">
            .ui-orderlist-list {
                list-style-type: none;
                margin: 0;
                padding: 0;
                overflow:auto;
                height:200px;
                width:100%;
            }
            .ui-fileupload-buttonbar {      /*important*/
                background: transparent none;
                border: none;
            }
            .ui-fileupload-content {      /*important*/
                display: none;
            }
            .ui-growl{
                top:100px;
            }
            .ui-panelgrid td, .ui-panelgrid tr
            {
                border-style: none !important
            }
            .actor-table{
                width:75%;
                margin: 0 auto;
                margin-bottom: 20px;
            }
            .icon-row{
                width:38px;
            }
            .description{
                margin:0 auto;
                width:500px;
            }
            .save-button{
                margin-right: 100px;
            }
            .name-and-date-release{
                margin:0 auto;
                padding:20px;

            }
            .top-labels{
                font-weight:bold;
                font-size:24px;
            }
            .color{
                background-color: rgb(224,224,224);
            }
            .start-header{
                margin-left: 100px;
                margin-right: 100px;
                margin-top: 0px;
            }
        </style>

    </h:head>
    <h:body>
        <script type="text/javascript">
            function addRowOnComplete() {
                jQuery('#supercoolnewrow').trigger('click');
            }
        </script>
        <!--        <ui:composition template="/template/internal-template.xhtml">
                    <ui:define name="content">-->
        <h1>Series editing slide</h1>
        <h:form id="form2">
            <div class="ui-grid ui-grid-responsive">
                <div class="ui-grid-row color start-header" >
                    <div class="ui-grid-col-8" > 
                        <h:panelGrid columns="2" cellspacing="20" class="name-and-date-release">
                            <!--Series name-->
                            <p:outputLabel value="Series name: " class="top-labels"/>
                            <p:inputText id="seriesName" value="#{seriesEdit.series.title}" class="color" 
                                         title="Examples: &#13; -Szökés &#13; -Spongy Bob" />

                            <!--Release date-->
                            <p:outputLabel value="Release date of series: " class="top-labels color"/>
                            <p:calendar id="date" value="#{seriesEdit.series.yearOfRelease}" pattern="dd/MM/yyyy" readonlyInput="true" 
                                        navigator="true" mindate="01/01/1920" maxdate="31/12/2016" yearRange="c-100:c+100"
                                        title="Format: dd/MM/yyyy" style="background-color: rgb(224,224,224) !important;" />
                        </h:panelGrid>
                    </div>
                    <div class="ui-grid-col-4">
                        <!--Picture-->
                        <h:panelGrid columns="2" cellspacing="0">
                            <p:fileUpload id="upload" mode="advanced" skinSimple="true" fileUploadListener="#{seriesEdit.pictureHandler.imageUpload(event)}" update="gi" auto="true"/>
                            <p:commandButton value="Reset">
                                <p:ajax listener="#{seriesEdit.pictureHandler.resetPicture(event)}" update="gi"/>
                            </p:commandButton>  
                        </h:panelGrid> 
                        <p:graphicImage id="gi" value="#{seriesEdit.pictureHandler.image}" width="230" height="180" cache="false"/>

                    </div>
                </div>
            </div>

            <p:separator />

            <!--List actors, directors, and seasons-->
            <div class="ui-grid ui-grid-responsive">
                <div class="ui-grid-row">
                    <div class="ui-grid-col-12">
                        <form id="actorFrom">
                            <p:dataTable id="actorListId" var="actorVar" value="#{seriesEdit.series.actors}" class="actor-table" editable="true">
                                <f:facet name="header">
                                    Actors               
                                </f:facet>


                                <p:ajax event="rowEdit" listener="#{dtEditView.onRowEdit}" update="actorListId" />
                                <p:ajax event="rowEditCancel" listener="#{dtEditView.onRowCancel}" update="actorListId" />


                                <p:column style="width:16px">
                                    <p:rowToggler />
                                </p:column>

                                <!--Actor title-->
                                <p:column headerText="Name">
                                    <p:cellEditor>
                                        <f:facet name="output"><h:outputText value="#{actorVar.name}" /></f:facet>
                                        <f:facet name="input"><p:inputText id="modelInput" value="#{actorVar.name}" style="width:100%"/></f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <!--Actor birthplace-->
                                <p:column headerText="Birthplace">

                                    <p:cellEditor>
                                        <f:facet name="output"><h:outputText value="#{actorVar.placeOfBirth}" /></f:facet>
                                        <f:facet name="input"><p:inputText value="#{actorVar.placeOfBirth}" style="width:100%"/></f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <!--Actor sex-->
                                <p:column headerText="Sex">
                                    <p:cellEditor>
                                        <f:facet name="output"><h:outputText value="#{actorVar.sex}" /></f:facet>
                                        <f:facet name="input"><p:inputText value="#{actorVar.sex}" style="width:100%"/></f:facet>
                                    </p:cellEditor>
                                </p:column>


                                <!--Trash-->
                                <p:column class="icon-row">
                                    <h:commandLink value="" action="#{seriesEdit.removeActorFromSeries(actorVar)}"  >
                                        <i class="fa fa-trash" ></i>
                                        <f:ajax render="actorListId" execute="actorListId"></f:ajax>
                                    </h:commandLink>
                                </p:column>

                                <p:rowExpansion id="actorRowExpansion">
                                    <p:panelGrid  columns="3"  style="width:80%;margin:0 auto;">
                                        <f:facet name="header">
                                            <p:graphicImage name="actor/#{actorVar.id}.jpg"/> 
                                        </f:facet>

                                        <!--Actor name-->
                                        <p:outputLabel value="Name: "/>
                                        <p:inputText id="nameInRE" value="#{actorVar.name}"/>
                                        <h:panelGroup />

                                        <!--Birthday-->
                                        <p:outputLabel value="Birthday: " />
                                        <p:calendar id="birthdayInRE" value="#{actorVar.dateOfBirth}" pattern="dd/MM/yyyy" readonlyInput="true" 
                                                    navigator="true" mindate="01/01/1920" maxdate="31/12/2010" yearRange="c-100:c+100"
                                                    title="Format: dd/MM/yyyy" />
                                        <h:panelGroup />

                                        <!--Birthplace-->
                                        <p:outputLabel value="Birthplace: "/>
                                        <p:inputText id="birthplaceInRE" value="#{actorVar.placeOfBirth}"/>
                                        <h:panelGroup />

                                        <!--Official website-->
                                        <h:outputText value="Official website:" style="text-align: right"/>
                                        <p:inputText id="websiteurlInRE" value="#{actorVar.officialWebsite}"></p:inputText>
                                        <h:panelGroup />
                                        <!--</p:panelGrid>-->

                                        <!--Picture-->
                                        <p:outputLabel value="Picutre: "/>
                                        <p:inputText value="#{actorVar.pathOfPhoto}"/>
                                        <p:fileUpload id="uploadInRE" mode="advanced" skinSimple="true" fileUploadListener="#{actorEdit.imageUpload}" auto="true"/>

                                        <p:growl id="growlInRE" life="2000" />
                                        <h:panelGrid columns="2" cellpadding="20px">
                                            <p:commandButton action="#{seriesEdit.saveSeries()}" actionListener="#{seriesEdit.saveButtonListener}" value="Save" 
                                                             update="growlInRE" icon="ui-icon-disk" title="Save" />
                                            <p:commandButton value="Reset" action="#{seriesEdit.resetSeries}"/> 

                                        </h:panelGrid>
                                    </p:panelGrid>

                                </p:rowExpansion>

                            </p:dataTable>



                            <!--Add panel-->
                            <h:panelGrid id="addPanel" columns="3" cellpadding="10" style="margin:0 auto" >
                                <p:selectOneMenu  id="btnSelect" value="#{seriesEdit.actorId}" style="width:250px">
                                    <f:selectItem itemLabel="Choose existing actor" itemValue="#{null}" />
                                    <f:selectItems value="#{seriesEdit.actorListNotInSeries}" var="actorVar" itemLabel="#{actorVar.name}" itemValue="#{actorVar.id}"/>
                                    <!--<p:ajax event="change" update="@this" />-->
                                    <p:ajax event="change" update="@this" />
                                </p:selectOneMenu>
                                <p:commandButton value="Add selected actor" title="Add"
                                                 action="#{seriesEdit.addExistingActorToSeries}" update="addPanel actorListId" process="@this" />
                                                 <!--action="#{seriesEdit.addExistingActorToSeries}" update="addPanel, actorListId" />-->
                            </h:panelGrid>

                            <p:commandButton value="Add new actor" action="#{seriesEdit.initialNewActor()}" oncomplete="PF('dlg').show();" icon="ui-icon-extlink"  process="@this" update="newActorDialog"/>
                            <!--oncomplete="dlg.show()"-->
                            <!--onclick="PF('dlg').show();"-->
                            <!--update="form2:newActorDialog"-->
                            <!--New actor dialog-->
                            <!--<h:form >-->


                            <!--</h:form>-->
                        </form>
                    </div>                                                  
                </div>
            </div>

            <p:separator />

            <!--Description panel-->
            <h:panelGrid class="description">
                <h:outputText value="Desctiption" />
                <p:inputTextarea rows="10" cols="60" value="#{seriesEdit.series.description}" 
                                 queryDelay="750" minQueryLength="4"  autoResize="true"/>
            </h:panelGrid>


            <!--Save panel-->
            <p:growl id="growl" life="2000" />
            <h:panelGrid class="save-button">
                <p:commandButton action="#{seriesEdit.saveSeries}" actionListener="#{seriesEdit.saveButtonListener(actionEvent)}" value="Save" 
                                 update="growl" icon="ui-icon-disk" title="Save" />
            </h:panelGrid>

        </h:form>

        <p:dialog id="newActorDialog" header="Add new actor" widgetVar="dlg" >
            <h:form>
                <p:panelGrid  columns="2"  style="width:80%;margin:0 auto;">

                    <!--Actor name-->
                    <p:outputLabel value="Name: "/>
                    <p:inputText id="nameInDl" value="#{seriesEdit.newActor.name}"/>

                    <!--Birthday-->
                    <p:outputLabel value="Birthday: " />
                    <p:calendar id="birthdayInDl" value="#{seriesEdit.newActor.dateOfBirth}" pattern="dd/MM/yyyy" readonlyInput="true" 
                                navigator="true" mindate="01/01/1920" maxdate="31/12/2010" yearRange="c-100:c+100"
                                title="Format: dd/MM/yyyy" />

                    <!--Birthplace-->
                    <p:outputLabel value="Birthplace: "/>
                    <p:inputText id="birthplaceInDl" value="#{seriesEdit.newActor.placeOfBirth}"/>

                    <!--Official website-->
                    <h:outputText value="Official website:" style="text-align: right"/>
                    <p:inputText id="websiteurlInDl" value="#{seriesEdit.newActor.officialWebsite}"></p:inputText>

                    <!--Picture-->
                    <p:outputLabel value="Picutre: "/>
                    <p:inputText id="pictureInDl" value="#{seriesEdit.newActor.pathOfPhoto}"/>

                    <p:commandButton value="Save" action="#{seriesEdit.addNewActorToSeries()}" oncomplete="PF('dlg').hide();" process="@form" update="form2:actorListId"/>
                    <p:commandButton value="Cancel" oncomplete="PF('dlg').hide();" /> 


                </p:panelGrid>
            </h:form>
        </p:dialog>



        <!--            </ui:define>
                </ui:composition>-->

    </h:body>

</html>
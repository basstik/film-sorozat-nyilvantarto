<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      >
    <!--    Important put this code in the web.xml
        <context-param>
            <param-name>javax.faces.FACELETS_SKIP_COMMENTS</param-name>
        <   param-value>true</param-value>
        </context-param>
    -->
    <h:head>
        <title>Series edit site</title>
        <style type="text/css">
            .ui-orderlist-list {
                list-style-type: none;
                margin: 0;
                padding: 0;
                overflow:auto;
                height:200px;
                width:100%;
            }
        </style>

    </h:head>
    <h:body>


        <h:form>
            <div class="ui-grid ui-grid-responsive">
                <div class="ui-grid-row">
                    <div class="ui-grid-col-1"> </div>
                    <div class="ui-grid-col-6"> 
                        <h:panelGrid columns="2" cellpadding="20" style="margin-top:60px">
                            <!--Series name-->
                            <p:outputLabel value="Series name: "/>
                            <p:inputText id="name" value="#{seriesEdit.series.title}"
                                         title="Examples: &#13; -Szökés &#13; -Spongy Bob"/>

                            <!--Release date-->
                            <p:outputLabel value="Release date of serie: " />
                            <p:calendar id="date" value="#{seriesEdit.series.yearOfRelease}" pattern="dd/MM/yyyy" readonlyInput="true" 
                                        navigator="true" mindate="01/01/1920" maxdate="31/12/2010" yearRange="c-100:c+100"
                                        title="Format: dd/MM/yyyy" />
                        </h:panelGrid>
                    </div>
                    <div class="ui-grid-col-5">
                        <!--Picture-->
                        <h:panelGrid columns="2" cellspacing="0">
                            <p:fileUpload id="upload" mode="simple" skinSimple="true" fileUploadListener="#{seriesEdit.imageUpload}" update="gi" auto="true"/>
                            <p:commandButton value="Reset">
                                <p:ajax listener="#{seriesEdit.resetPicture}" update="gi"/>
                            </p:commandButton>                    
                        </h:panelGrid> 
                        <p:outputLabel value="Picture: "/>
                        <p:graphicImage id="gi" value="#{seriesEdit.image}" width="230" height="180" cache="false"/>

                    </div>
                </div>
            </div>

            <p:separator />

            <!--List actors, directors, and seasons-->
            <div class="ui-grid ui-grid-responsive">
                <div class="ui-grid-row">
                    <div class="ui-grid-col-4">
                        <!--Add Actor-->
                        <h3 style="margin-top: 0">Actor</h3>
                        <p:growl id="msgs" showDetail="true" />
                        <p:orderList  value="#{seriesEdit.actorList}" id="actorListId" var="actorVar" itemLabel="#{actorVar}" itemValue="#{actorVar}" controlsLocation="none" style="margin-top: 0">

                            <f:facet name="actors">Actors</f:facet>

                            Actor title
                            <p:column style="width:50px">
                                <p:link outcome="actorEdit.xhtml" value="#{actorVar.name}">
                                    <f:param name="actorId" value="#{actorVar.id}" />
                                </p:link>
                            </p:column>

                            <!--Edit actor button-->
                            <p:column style="width:60px">
                                <p:commandButton  action="#{seriesEdit.goToActorEditSite()}" icon="ui-icon-edit" title="Edit">
                                    <f:param name="actorId" value="#{actorVar.id}" />
                                </p:commandButton>
                            </p:column>

                            <!--Remove actor button-->
                            <p:column style="width:50px">
                                <p:commandButton action="#{seriesEdit.removeActorFromSeries}" update="actorListId" icon="ui-icon-trash" title="Remove">
                                    <f:param name="actorId" value="#{actorVar.id}" />
                                </p:commandButton>
                            </p:column>
                        </p:orderList>


                        <!-- Dropdown  actor list to add new actor to series -->

                        <h:form id="myform">
                            <h:panelGrid columns="2" cellpadding="5">
                                <f:facet name="input">
                                    <p:selectOneMenu  id="btnSelect" value="#{seriesEdit.actor}">
                                        <f:selectItem itemLabel="Choose Actor" itemValue="" />
                                        <f:selectItems value="#{seriesEdit.actorListNotInSeries}" var="actor" itemLabel="#{actor.name}" itemValue="#{actor.name}"/>
                                    </p:selectOneMenu>
                                </f:facet>

                                <f:facet name="output">
                                    <h:outputText value="#{seriesEdit.actor.name}" />
                                </f:facet>

                                <p:commandButton id="addBtn" value="Add" icon="ui-icon-add" title="Add"
                                                 action="#{seriesEdit.addActorToSeries()}" update="@(form)" />

                            </h:panelGrid>
                        </h:form>

                    </div>
                </div>
            </div>

            <!--Description panel-->
            <p:inputTextarea rows="10" cols="50" completeMethod="#{seriesEdit.series.description}" queryDelay="750" minQueryLength="4" style="margin:0 auto;"/>

        </h:form>
    </h:body>
</html>
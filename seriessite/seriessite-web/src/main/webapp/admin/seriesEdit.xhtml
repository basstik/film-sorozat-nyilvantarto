<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      >

    <f:metadata>
        <f:viewParam name="seriesid" value="#{seriesEdit.idOfSeries}" />
        <f:event type="preRenderView" listener="#{seriesEdit.loadDatabaseData}" />

    </f:metadata>

    <h:head>
        <title>Series edit site</title>

        <link rel="stylesheet" href="#{request.contextPath}/resources/font-awesome/css/font-awesome.min.css"/>


        <style type="text/css">
            .ui-orderlist-list {
                list-style-type: none;
                margin: 0;
                padding: 0;
                overflow:auto;
                height:200px;
                width:100%;
            }

            .ui-fileupload-content {
                display: none;
            }
            .ui-fileupload-buttonbar.ui-widget-header {
                background-color: transparent;
                border: 0 none;
            }
            .ui-growl{
                top:100px;
            }
            .actor-table{
                width:100%;
                margin: 0 auto;
                margin-bottom: 20px;
            }
        </style>

    </h:head>
    <h:body>
        <!--        <ui:composition template="/template/internal-template.xhtml">
                    <ui:define name="content">-->
        <h:form id="form2">
            <div class="ui-grid ui-grid-responsive">
                <div class="ui-grid-row">
                    <div class="ui-grid-col-8"> 
                        <h:panelGrid columns="2" cellspacing="20" style="margin-top:60px;margin-left:40px;padding:20px">
                            <!--Series name-->
                            <p:outputLabel value="Series name: "/>
                            <p:inputText id="name" value="#{seriesEdit.series.title}"
                                         title="Examples: &#13; -Szökés &#13; -Spongy Bob"/>

                            <!--Release date-->
                            <p:outputLabel value="Release date of series: " />
                            <p:calendar id="date" value="#{seriesEdit.series.yearOfRelease}" pattern="dd/MM/yyyy" readonlyInput="true" 
                                        navigator="true" mindate="01/01/1920" maxdate="31/12/2010" yearRange="c-100:c+100"
                                        title="Format: dd/MM/yyyy" />
                        </h:panelGrid>
                    </div>
                    <div class="ui-grid-col-4">
                        <!--Picture-->
                        <h:panelGrid columns="2" cellspacing="0">
                            <p:fileUpload id="upload" mode="advanced" skinSimple="true" fileUploadListener="#{seriesEdit.pictureHandler.imageUpload(event)}" update="gi" auto="true"/>
                            <p:commandButton value="Reset">
                                <p:ajax listener="#{seriesEdit.pictureHandler.resetPicture(event)}" update="gi"/>
                            </p:commandButton>  
                        </h:panelGrid> 
                        <p:graphicImage id="gi" value="#{seriesEdit.pictureHandler.image}" width="230" height="180" cache="false"/>

                    </div>
                </div>
            </div>

            <p:separator />
            <div class="ui-grid ui-grid-responsive">
                <div class="ui-grid-row">
                    <div class="ui-grid-col-4">
                        4
                    </div>
                    <div class="ui-grid-col-4">
                        4
                    </div>
                    <div class="ui-grid-col-4">
                        4
                    </div>
                </div>
            </div>

            <!--List actors, directors, and seasons-->
            <div class="ui-grid ui-grid-responsive">
                <div class="ui-grid-row">
                    <div class="ui-grid-col-12">
                        <form id="actorFrom">
                            <p:dataTable id="actorListId" var="actorVar" value="#{seriesEdit.actorList}" class="actor-table" editable="true">
                                <f:facet name="header">
                                    Actors               
                                </f:facet>

                                <p:ajax event="rowEdit" listener="#{dtEditView.onRowEdit}" update="actorListId" />
                                <p:ajax event="rowEditCancel" listener="#{dtEditView.onRowCancel}" update="actorListId" />

                                <!--Actor title-->
                                <!--                                <p:column >
                                                                    <p:link outcome="actorEdit.xhtml" value="#{actorVar.name}">
                                                                        <f:param name="actorId" value="#{actorVar.id}" />
                                                                    </p:link>
                                                                </p:column>-->

                                <p:column headerText="Name" footerText="Name">
                                    <p:cellEditor>
                                        <f:facet name="output"><h:outputText value="#{actorVar.name}" /></f:facet>
                                        <f:facet name="input"><p:inputText id="modelInput" value="#{actorVar.name}" style="width:100%"/></f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <p:column headerText="Birthplace" footerText="Birthplace">
                                    <p:cellEditor>
                                        <f:facet name="output"><h:outputText value="#{actorVar.placeOfBirth}" /></f:facet>
                                        <f:facet name="input"><p:inputText value="#{actorVar.placeOfBirth}" style="width:100%"/></f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <!--Edit actor button-->
                                <p:column style="width:38px;">
                                    <p:commandButton  action="#{seriesEdit.goToActorEditSite()}" icon="ui-icon-edit" title="Edit">
                                        <f:param name="actorId" value="#{actorVar.id}" />
                                    </p:commandButton>
                                </p:column>

                                <!--Remove actor button-->
                                <p:column style="width:38px;">
                                    <p:commandButton icon="ui-icon-trash" title="Remove"   
                                                     action="#{seriesEdit.removeActorFromSeries(actorVar)}" update="actorListId,form2:addPanel">

                                    </p:commandButton>

                                </p:column>

                                <p:column>
                                    <h:commandLink value="" action="#{seriesEdit.removeActorFromSeries(actorVar)}"  >
                                        <i class="fa fa-trash" ></i>
                                        <f:ajax render="actorListId" execute="actorListId"></f:ajax>
                                    </h:commandLink>
                                </p:column>

                                <p:column style="width:32px">
                                    <p:rowEditor />
                                </p:column>

                            </p:dataTable>

                            <!--Add panel-->
                            <h:panelGrid id="addPanel" columns="2" cellpadding="10" style="margin:0 auto" >
                                <p:selectOneMenu  id="btnSelect" value="#{seriesEdit.actorId}" style="width:150px">
                                    <f:selectItem itemLabel="Choose Actor" itemValue="#{null}" />
                                    <f:selectItems value="#{seriesEdit.actorListNotInSeries}" var="actorVar" itemLabel="#{actorVar.name}" itemValue="#{actorVar.id}"/>
                                    <p:ajax event="change" update="@this" />
                                </p:selectOneMenu>
                                <p:commandButton value="Add" title="Add"
                                                 action="#{seriesEdit.addActorToSeries}" update="addPanel, actorListId">
                                </p:commandButton>

                            </h:panelGrid>
                        </form>
                    </div>                                                  
                </div>
            </div>

            <p:separator />

            <!--Description panel-->
            <h:panelGrid style="margin:0 auto">
                <h:outputText value="Desctiption" />
                <p:inputTextarea rows="10" cols="60" value="#{seriesEdit.series.description}" 
                                 queryDelay="750" minQueryLength="4"  autoResize="true"/>
            </h:panelGrid>


            <!--Save panel-->
            <p:growl id="growl" life="2000" />
            <h:panelGrid>
                <p:commandButton action="#{seriesEdit.saveSeries}" actionListener="#{seriesEdit.saveButtonAction}" value="Save" 
                                 update="growl" icon="ui-icon-disk" title="Save" />
            </h:panelGrid>





        </h:form>
        <!--            </ui:define>
                </ui:composition>-->

    </h:body>

</html>
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:body>
        <ui:composition template="/template/internal-template.xhtml">
            <ui:define name="content">
                <p:tabView id="tabView" style="border: none">

                    <p:ajax event="tabChange" listener="#{queries.onTabChange}" update="form" resetValues="true"/>
                    <p:tab title="Actors by Series" id="ActorsBySeriesTab">
                        <h1 style="text-align: center;">Actors</h1>
                        <h2 style="text-align: center">from series after the given date</h2><br/><br/>
                        <p:panelGrid columns="2" style="margin: 0 auto;" styleClass="ui-noborder">
                            <p:outputLabel value="Date: " />
                            <p:calendar id="date" value="#{queries.date}" pattern="dd/MM/yyyy" readonlyInput="true" 
                                        navigator="true" mindate="01/01/1900" maxdate="20/05/2016" yearRange="c-120:c+100" 
                                        required="true" requiredMessage="This field has to be filled."/>
                            <h:panelGroup/>
                            <p:message for="date"/>
                            <h:panelGroup/>
                            <p:commandButton value="Search" action="#{queries.actorsFromSeriesAfterGivenDate()}" 
                                             process="ActorsBySeriesTab" update="form"/>
                        </p:panelGrid>
                        <br/><br/>
                        <p:panelGrid columns="1" style="margin: 0 auto; width: 40%; text-align: center;" styleClass="ui-noborder">
                            <p:outputLabel value="Result: "/>
                            <p:outputPanel style="border: #080808 solid thin">
                                <ui:repeat var="actor" value="#{queries.actors}">
                                    <p:commandLink value="#{actor.name}"/>
                                    <br/>
                                </ui:repeat>
                            </p:outputPanel> 
                        </p:panelGrid> 
                    </p:tab>
                    
                    <p:tab title="Series by Episodes" id="SeriesByNumberOfEpisodesTab">
                        <h1 style="text-align: center;">Series</h1>
                        <h2 style="text-align: center">with more episodes</h2><br/><br/>
                        <p:panelGrid columns="2" style="margin: 0 auto;" styleClass="ui-noborder">
                            <p:outputLabel value="Number of episodes: " />
                            <p:inputText id="noe" value="#{queries.numberOfEpisodes}"
                                         converterMessage="Format: integer between 0-10000."
                                         validatorMessage="Format: integer between 0-10000.">
                                <f:validateLongRange minimum="0" maximum="10000" />
                                <p:ajax event="blur" update="noe m_noe" />
                            </p:inputText>
                            <h:panelGroup/>
                            <p:message id="m_noe" for="noe"/>
                            <h:panelGroup/>
                            <p:commandButton value="Search" action="#{queries.seriesWithMoreEpisode()}" 
                                             process="SeriesByNumberOfEpisodesTab" update="form"/>
                        </p:panelGrid>
                        <br/><br/>
                        <p:panelGrid columns="1" style="margin: 0 auto; width: 40%; text-align: center;" styleClass="ui-noborder">
                            <p:outputLabel value="Result: "/>
                            <p:outputPanel style="border: #080808 solid thin">
                                <ui:repeat var="s" value="#{queries.series}">
                                    <p:link outcome="#{queries.goToSeriesPage()}" value="#{s.title}">
                                        <f:param name="seriesid" value="#{s.id}" />
                                    </p:link>
                                    <br/>
                                </ui:repeat>
                            </p:outputPanel>
                        </p:panelGrid>
                    </p:tab>

                    <p:tab title="Users by Comments" id="UsersByComments">
                        <h1 style="text-align: center;">Users</h1>
                        <h2 style="text-align: center">with the most comments</h2><br/><br/><br/>
                            
                        <div style="text-align: center">
                            <p:commandButton value="Search" action="#{queries.userByMostComment()}" 
                                             process="UsersByComments" update="form"/>
                        </div>
                        <br/><br/>
                        <p:panelGrid columns="1" style="margin: 0 auto; width: 40%; text-align: center;" styleClass="ui-noborder">
                            <p:outputLabel value="Result: "/>
                            <p:outputPanel style="border: #080808 solid thin">
                                <ui:repeat var="uwmc" value="#{queries.usersWithMostComments}">
                                    <p:link outcome="#{profile.goToProfilePage()}" value="#{uwmc}">
                                        <f:param name="username" value="#{queries.getUsername(uwmc)}" />
                                    </p:link>
                                    <br/>
                                </ui:repeat>
                            </p:outputPanel>
                        </p:panelGrid>
                    </p:tab>
                    
                    <p:tab title="Series by Directors" id="SeriesByDirectorTab">
                        <h1 style="text-align: center;">Series</h1>
                        <h2 style="text-align: center">by Director whose original name equals to their stage name</h2><br/><br/><br/>
                        
                        <div style="text-align: center">
                            <p:commandButton value="Search" action="#{queries.seriesByDirectorOriginalNameEqualsName()}" 
                                             process="SeriesByDirectorTab" update="form"/>
                        </div>
                        <br/><br/>
                        <p:panelGrid columns="1" style="margin: 0 auto; width: 40%; text-align: center;" styleClass="ui-noborder">
                            <p:outputLabel value="Result: "/>
                            <p:outputPanel style="border: #080808 solid thin">
                                <ui:repeat var="s" value="#{queries.series}">
                                    <p:link outcome="#{queries.goToSeriesPage()}" value="#{s.title}">
                                        <f:param name="seriesid" value="#{s.id}" />
                                    </p:link>
                                    <br/>
                                </ui:repeat>
                            </p:outputPanel>
                        </p:panelGrid>
                    </p:tab>

                    <p:tab title="Series by Comments" id="SeriesByCommentDate">
                        <h1 style="text-align: center;">Series</h1>
                        <h2 style="text-align: center">commented after the given date</h2><br/><br/>
                        <p:panelGrid columns="2" style="margin: 0 auto;" styleClass="ui-noborder">
                            <p:outputLabel value="Date: " />
                            <p:calendar id="commentDate" value="#{queries.date}" pattern="dd/MM/yyyy" readonlyInput="true" 
                                        navigator="true" mindate="01/01/1900" maxdate="20/05/2016" yearRange="c-120:c+100" 
                                        required="true" requiredMessage="This field has to be filled."/>
                            <h:panelGroup/>
                            <p:message for="commentDate"/>
                            <h:panelGroup/>
                            <p:commandButton value="Search" action="#{queries.seriesCommentedAfterGivenDate()}" 
                                             process="SeriesByCommentDate" update="form"/>
                        </p:panelGrid>
                        <br/><br/>
                        <p:panelGrid columns="1" style="margin: 0 auto; width: 40%; text-align: center;" styleClass="ui-noborder">
                            <p:outputLabel value="Result: "/>
                            <p:outputPanel style="border: #080808 solid thin">
                                <ui:repeat var="s" value="#{queries.series}">
                                    <p:link outcome="#{queries.goToSeriesPage()}" value="#{s.title}">
                                        <f:param name="seriesid" value="#{s.id}" />
                                    </p:link>
                                    <br/>
                                </ui:repeat>
                            </p:outputPanel>
                        </p:panelGrid>
                    </p:tab>
                </p:tabView>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

